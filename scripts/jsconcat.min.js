function populateStudents(t,e){t=calculateRank(t=calculateTotal(t)),e&&(t=sortByFieldFn(t,e)),row="";for(var o=0;o<t.length;o++)student=t[o],row+="<tr>",row=row+"<td>"+(o+1)+"</td>",row=row+"<td>"+student.name+"</td>",row=row+"<td>"+student.regNo+"</td>",row=row+"<td>"+student.dob+"</td>",row=row+"<td>"+student.eng+"</td>",row=row+"<td>"+student.maths+"</td>",row=row+"<td>"+student.sci+"</td>",row=row+"<td>"+student.french+"</td>",row=row+"<td>"+student.hist+"</td>",row=row+"<td>"+student.total+"</td>",row=row+"<td>"+student.rank+"</td>",row+="<td>",row=row+'<button class="btn btn-warning btn-update" data-student-id="'+student._id.$oid+'"><span class="fa fa-pencil fa-lg"> </span></button>',row=row+'<button class="btn btn-danger btn-delete" data-student-id="'+student._id.$oid+'"><span class="fa fa-trash fa-lg"> </span> </button>',row+="</td>",row+="</tr>";jQuery("#studentsTable").find("tbody").html(row)}function calculateTotal(t){return t.forEach(function(t){t.total=0,t.total=t.total+parseInt(t.eng),t.total=t.total+parseInt(t.maths),t.total=t.total+parseInt(t.sci),t.total=t.total+parseInt(t.french),t.total=t.total+parseInt(t.hist)}),t}function calculateRank(t){return t=t.sort(function(t,e){return e.total-t.total}),rank=1,t.forEach(function(t){t.rank=rank,rank++}),t}function sortByFieldFn(t,o){return t=t.sort(function(t,e){return t[o]>e[o]})}backupOfStudents=[],jQuery.ajax({url:"https://api.mlab.com/api/1/databases/sit/collections/students/?apiKey="+api_key,method:"GET",success:function(t){console.log("response",t),populateStudents(backupOfStudents=t)},error:function(t){console.log("err",t)}}),jQuery("#search").keyup(function(){console.log("key is up"),search=jQuery(this).val(),console.log("search",search),jQuery("#studentsTable tbody tr").each(function(){text=jQuery(this).find("td:eq(1)").text(),textValue=text.trim().toLowerCase(),searchValue=search.trim().toLowerCase(),indexValue=textValue.indexOf(searchValue),console.log("text",text),console.log(textValue.indexOf(searchValue)),-1!=indexValue?jQuery(this).show():jQuery(this).hide()})}),jQuery(".sortit").click(function(){sortByField=jQuery(this).attr("data-sorter"),populateStudents(backupOfStudents,sortByField)}),jQuery(document).on("click",".btn-update",function(){studentid=jQuery(this).attr("data-student-id"),location.href="update.html?studentid="+studentid}),jQuery(document).on("click",".btn-delete",function(){studentid=jQuery(this).attr("data-student-id"),jQuery("#deleteModal").find("#deleteYesBtn").attr("data-student-id",studentid),jQuery("#deleteModal").modal("show")}),jQuery("#deleteYesBtn").click(function(){console.log("User has agreed to delete."),studentid=jQuery(this).attr("data-student-id"),console.log(studentid),jQuery.ajax({method:"DELETE",url:"https://api.mlab.com/api/1/databases/sit/collections/students/"+studentid+"?apiKey="+api_key,success:function(){jQuery("#deleteModal").modal("hide"),location.reload()},error:function(){}})});